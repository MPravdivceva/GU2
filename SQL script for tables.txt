CREATE TABLE  "DEPT" 
   (	"DEPTNO" NUMBER(2,0), 
	"DNAME" VARCHAR2(14) COLLATE "USING_NLS_COMP", 
	"LOC" VARCHAR2(13) COLLATE "USING_NLS_COMP", 
	 PRIMARY KEY ("DEPTNO")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "DEPT_TRG1" 
              before insert on dept
              for each row
              begin
                  if :new.deptno is null then
                      select dept_seq.nextval into :new.deptno from sys.dual;
                 end if;
              end;
/
ALTER TRIGGER  "DEPT_TRG1" ENABLE
/
CREATE TABLE  "EMP" 
   (	"EMPNO" NUMBER(4,0) NOT NULL ENABLE, 
	"ENAME" VARCHAR2(10) COLLATE "USING_NLS_COMP", 
	"JOB" VARCHAR2(9) COLLATE "USING_NLS_COMP", 
	"MGR" NUMBER(4,0), 
	"HIREDATE" DATE, 
	"SAL" NUMBER(7,2), 
	"COMM" NUMBER(7,2), 
	"DEPTNO" NUMBER(2,0), 
	 PRIMARY KEY ("EMPNO")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
ALTER TABLE  "EMP" ADD FOREIGN KEY ("MGR")
	  REFERENCES  "EMP" ("EMPNO") ENABLE
/
ALTER TABLE  "EMP" ADD FOREIGN KEY ("DEPTNO")
	  REFERENCES  "DEPT" ("DEPTNO") ENABLE
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "EMP_TRG1" 
              before insert on emp
              for each row
              begin
                  if :new.empno is null then
                      select emp_seq.nextval into :new.empno from sys.dual;
                 end if;
              end;
/
ALTER TRIGGER  "EMP_TRG1" ENABLE
/
CREATE TABLE  "CLOTHING_LOOKUP" 
   (	"CLOTHING_ID" NUMBER NOT NULL ENABLE, 
	"CLOTHING" VARCHAR2(4000) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("CLOTHING_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "T_CLOTHING_LOOKUP" before insert or update on "CLOTHING_LOOKUP" for each row begin if inserting and :new."CLOTHING_ID" is null then 
  for c1 in (select "CLOTHING_LOOKUP_SEQ".nextval nv from dual) loop 
     :new."CLOTHING_ID" := c1.nv;   end loop; end if; end;

/
ALTER TRIGGER  "T_CLOTHING_LOOKUP" ENABLE
/
CREATE TABLE  "DEPARTMENT_LOOKUP" 
   (	"DEPARTMENT_ID" NUMBER NOT NULL ENABLE, 
	"DEPARTMENT" VARCHAR2(4000) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("DEPARTMENT_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "T_DEPARTMENT_LOOKUP" before insert or update on "DEPARTMENT_LOOKUP" for each row begin if inserting and :new."DEPARTMENT_ID" is null then 
  for c1 in (select "DEPARTMENT_LOOKUP_SEQ".nextval nv from dual) loop 
     :new."DEPARTMENT_ID" := c1.nv;   end loop; end if; end;

/
ALTER TRIGGER  "T_DEPARTMENT_LOOKUP" ENABLE
/
CREATE TABLE  "COLOR_LOOKUP" 
   (	"COLOR_ID" NUMBER NOT NULL ENABLE, 
	"COLOR" VARCHAR2(4000) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("COLOR_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/

CREATE OR REPLACE EDITIONABLE TRIGGER  "T_COLOR_LOOKUP" before insert or update on "COLOR_LOOKUP" for each row begin if inserting and :new."COLOR_ID" is null then 
  for c1 in (select "COLOR_LOOKUP_SEQ".nextval nv from dual) loop 
     :new."COLOR_ID" := c1.nv;   end loop; end if; end;

/
ALTER TRIGGER  "T_COLOR_LOOKUP" ENABLE
/
CREATE TABLE  "CUSTOMERS" 
   (	"CUSTOMER_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 400 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"FULL_NAME" VARCHAR2(255) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"EMAIL_ADDRESS" VARCHAR2(255) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 CONSTRAINT "CUSTOMERS_PK" PRIMARY KEY ("CUSTOMER_ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "CUSTOMERS_EMAIL_U" UNIQUE ("EMAIL_ADDRESS")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/

CREATE INDEX  "CUSTOMERS_NAME_I" ON  "CUSTOMERS" ("FULL_NAME")
/
CREATE TABLE  "STORES" 
   (	"STORE_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 25 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"STORE_NAME" VARCHAR2(255) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"WEB_ADDRESS" VARCHAR2(100) COLLATE "USING_NLS_COMP", 
	"PHYSICAL_ADDRESS" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"LOGO" BLOB, 
	"LOGO_MIME_TYPE" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"LOGO_FILENAME" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"LOGO_CHARSET" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"LOGO_LAST_UPDATED" DATE, 
	 CONSTRAINT "STORES_PK" PRIMARY KEY ("STORE_ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "STORE_NAME_U" UNIQUE ("STORE_NAME")
  USING INDEX  ENABLE, 
	 CONSTRAINT "STORE_AT_LEAST_ONE_ADDRESS_C" CHECK (coalesce ( web_address, physical_address ) is not null) ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "PRODUCTS" 
   (	"PRODUCT_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 50 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"PRODUCT_NAME" VARCHAR2(255) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"UNIT_PRICE" NUMBER(10,2), 
	"PRODUCT_DETAILS" BLOB, 
	"PRODUCT_IMAGE" BLOB, 
	"IMAGE_MIME_TYPE" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"IMAGE_FILENAME" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"IMAGE_CHARSET" VARCHAR2(512) COLLATE "USING_NLS_COMP", 
	"IMAGE_LAST_UPDATED" DATE, 
	"COLOR_ID" NUMBER, 
	"DEPARTMENT_ID" NUMBER, 
	"CLOTHING_ID" NUMBER, 
	 CONSTRAINT "PRODUCTS_PK" PRIMARY KEY ("PRODUCT_ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "PRODUCT_JSON_C" CHECK (product_details is json) ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
ALTER TABLE  "PRODUCTS" ADD FOREIGN KEY ("COLOR_ID")
	  REFERENCES  "COLOR_LOOKUP" ("COLOR_ID") ENABLE
/
ALTER TABLE  "PRODUCTS" ADD FOREIGN KEY ("DEPARTMENT_ID")
	  REFERENCES  "DEPARTMENT_LOOKUP" ("DEPARTMENT_ID") ENABLE
/
ALTER TABLE  "PRODUCTS" ADD FOREIGN KEY ("CLOTHING_ID")
	  REFERENCES  "CLOTHING_LOOKUP" ("CLOTHING_ID") ENABLE
/
CREATE TABLE  "ORDERS" 
   (	"ORDER_ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 2000 NOCACHE  NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ORDER_DATETIME" TIMESTAMP (6) NOT NULL ENABLE, 
	"CUSTOMER_ID" NUMBER NOT NULL ENABLE, 
	"ORDER_STATUS" VARCHAR2(10) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"STORE_ID" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "ORDERS_PK" PRIMARY KEY ("ORDER_ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ORDER_STATUS_C" CHECK (order_status in ('CANCELLED','COMPLETE','OPEN','PAID','REFUNDED','SHIPPED')) ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
ALTER TABLE  "ORDERS" ADD CONSTRAINT "ORDERS_CUSTOMER_ID_FK" FOREIGN KEY ("CUSTOMER_ID")
	  REFERENCES  "CUSTOMERS" ("CUSTOMER_ID") ON DELETE CASCADE ENABLE
/
ALTER TABLE  "ORDERS" ADD CONSTRAINT "ORDERS_STORE_ID_FK" FOREIGN KEY ("STORE_ID")
	  REFERENCES  "STORES" ("STORE_ID") ON DELETE CASCADE ENABLE
/

CREATE INDEX  "ORDERS_CUSTOMER_ID_I" ON  "ORDERS" ("CUSTOMER_ID")
/

CREATE INDEX  "ORDERS_STORE_ID_I" ON  "ORDERS" ("STORE_ID")
/
CREATE TABLE  "ORDER_ITEMS" 
   (	"ORDER_ID" NUMBER NOT NULL ENABLE, 
	"LINE_ITEM_ID" NUMBER NOT NULL ENABLE, 
	"PRODUCT_ID" NUMBER NOT NULL ENABLE, 
	"UNIT_PRICE" NUMBER(10,2) NOT NULL ENABLE, 
	"QUANTITY" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "ORDER_ITEMS_PK" PRIMARY KEY ("ORDER_ID", "LINE_ITEM_ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "ORDER_ITEMS_PRODUCT_U" UNIQUE ("PRODUCT_ID", "ORDER_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
ALTER TABLE  "ORDER_ITEMS" ADD CONSTRAINT "ORDER_ITEMS_ORDER_ID_FK" FOREIGN KEY ("ORDER_ID")
	  REFERENCES  "ORDERS" ("ORDER_ID") ON DELETE CASCADE ENABLE
/
ALTER TABLE  "ORDER_ITEMS" ADD CONSTRAINT "ORDER_ITEMS_PRODUCT_ID_FK" FOREIGN KEY ("PRODUCT_ID")
	  REFERENCES  "PRODUCTS" ("PRODUCT_ID") ON DELETE CASCADE ENABLE
/
